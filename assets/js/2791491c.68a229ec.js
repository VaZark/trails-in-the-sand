"use strict";(self.webpackChunktil_remaster=self.webpackChunktil_remaster||[]).push([[2705],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(r),m=a,y=p["".concat(s,".").concat(m)]||p[m]||d[m]||l;return r?n.createElement(y,i(i({ref:t},c),{},{components:r})):n.createElement(y,i({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,i=new Array(l);i[0]=p;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var u=2;u<l;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},2193:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return p}});var n=r(7462),a=r(3366),l=(r(7294),r(3905)),i=["components"],o={},s="Querysets",u={unversionedId:"django/db/Querysets",id:"django/db/Querysets",title:"Querysets",description:"What are Querysets ?",source:"@site/docs-python/django/db/Querysets.md",sourceDirName:"django/db",slug:"/django/db/Querysets",permalink:"/docs-python/django/db/Querysets",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Prefetching",permalink:"/docs-python/django/db/Prefetching"},next:{title:"Custom Validations",permalink:"/docs-python/django/drf/Custom Validations"}},c=[{value:"What are Querysets ?",id:"what-are-querysets-",children:[],level:2},{value:"Lazy Evaluation",id:"lazy-evaluation",children:[],level:2},{value:"Caching",id:"caching",children:[],level:2},{value:"Queryset as Managers",id:"queryset-as-managers",children:[],level:2},{value:"Common filters",id:"common-filters",children:[],level:2}],d={toc:c};function p(e){var t=e.components,r=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"querysets"},"Querysets"),(0,l.kt)("h2",{id:"what-are-querysets-"},"What are Querysets ?"),(0,l.kt)("p",null,"A ",(0,l.kt)("em",{parentName:"p"},"QuerySet")," represents a collection of objects from your database. It can have zero, one or many filters. Filters are used to narrow down the query results based on the given parameters. "),(0,l.kt)("p",null,"To retrieve objects from the database, we construct a QuerySet via a ",(0,l.kt)("em",{parentName:"p"},"Manager")," on the model class."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},"all_entries = Entry.objects.all()\nfiltered_entries = Entry.objects.filter(pub_date__year=2006)\nentries_after_excluded = Entry.objects.exclude(foreignKey=instanceObj)\nchained_filters = Entry.objects.filter(pub_date__year=2006).exclude(pub_date__gte=datetime.date.today()\n")),(0,l.kt)("h2",{id:"lazy-evaluation"},"Lazy Evaluation"),(0,l.kt)("p",null,"QuerySets are lazy. Django will actually run the query only when the QuerySet is evaluated, ie during,"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Iteration"),(0,l.kt)("li",{parentName:"ul"},"Slicing"),(0,l.kt)("li",{parentName:"ul"},"len() / list() / repr() / bool()"),(0,l.kt)("li",{parentName:"ul"},"Pickling/Caching")),(0,l.kt)("h2",{id:"caching"},"Caching"),(0,l.kt)("p",null,"Each QuerySet contains a cache to minimize database access. The first time a QuerySet is evaluated the application saves the query results in the QuerySet\u2019s cache and returns the results that have been explicitly requested (e.g., the next element, if the QuerySet is being iterated over). ",(0,l.kt)("em",{parentName:"p"},"Subsequent evaluations of the QuerySet reuse the cached results.")),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Querysets do not always cache their results"),". If the cache is empty and the app does a lookup, the value is not cached and the CD will be hit for each request made."),(0,l.kt)("h2",{id:"queryset-as-managers"},"Queryset as Managers"),(0,l.kt)("p",null,"Sometimes we need a specific reuseable logic in certain workflows. However we would not wish to tie down or change the models as they are generic an can be extended by other apps / workflows. In this scenario, we can leverage custom Querysets and Managers."),(0,l.kt)("p",null,"When we are using the manager only for custom querysets and no Manager method are invloved, we can use ",(0,l.kt)("inlineCode",{parentName:"p"},"as_manager()")," over a custom Queryset to let django generate a Manager based on it."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-python"},"class CustomQueryset(models.QuerySet):\n    def filter_1(self):\n        return self.filter(field_1__gte=45)\n\n    def filter_2(self, val):\n        return self.filter(field_2__lt=val)\n\nclass SampleModel(models.Model):\n    name = models.CharField(max_length=30)\n    field_1 = models.IntegerField(default=0)\n    field_2 = models.FloatField(max_length=10)\n\n    custom_manager = CustomQueryset.as_manager()\n")),(0,l.kt)("h2",{id:"common-filters"},"Common filters"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"exact, iexact"),(0,l.kt)("li",{parentName:"ul"},"contains, icontains"),(0,l.kt)("li",{parentName:"ul"},"startswith, istartswith"),(0,l.kt)("li",{parentName:"ul"},"endswith, iendswith"),(0,l.kt)("li",{parentName:"ul"},"regex"),(0,l.kt)("li",{parentName:"ul"},"range"),(0,l.kt)("li",{parentName:"ul"},"date",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"year"),(0,l.kt)("li",{parentName:"ul"},"quarter (accepts ","[1,4]",")"),(0,l.kt)("li",{parentName:"ul"},"month"),(0,l.kt)("li",{parentName:"ul"},"week"),(0,l.kt)("li",{parentName:"ul"},"day"))),(0,l.kt)("li",{parentName:"ul"},"time",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"hour"),(0,l.kt)("li",{parentName:"ul"},"minute"),(0,l.kt)("li",{parentName:"ul"},"second")))))}p.isMDXComponent=!0}}]);