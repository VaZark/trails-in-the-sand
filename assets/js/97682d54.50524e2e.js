"use strict";(self.webpackChunktil_remaster=self.webpackChunktil_remaster||[]).push([[5072],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(k,o(o({ref:t},p),{},{components:n})):a.createElement(k,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2184:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],l={},s="Testing",c={unversionedId:"Basics/Testing",id:"Basics/Testing",title:"Testing",description:"General notes for tests and the default unittest module.",source:"@site/docs-python/Basics/Testing.md",sourceDirName:"Basics",slug:"/Basics/Testing",permalink:"/docs-python/Basics/Testing",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"What are Mixins?",permalink:"/docs-python/Basics/Mixins"},next:{title:"Miscellaneous Libraries",permalink:"/docs-python/Basics/useful libs/Misc lib"}},p=[{value:"Core Rules",id:"core-rules",children:[],level:2},{value:"Assertions",id:"assertions",children:[],level:2},{value:"Fixtures",id:"fixtures",children:[],level:2},{value:"Mocks",id:"mocks",children:[],level:2},{value:"Skip Tests",id:"skip-tests",children:[],level:2}],u={toc:p};function d(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"testing"},"Testing"),(0,i.kt)("p",null,"General notes for tests and the default ",(0,i.kt)("inlineCode",{parentName:"p"},"unittest")," module."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Structure:")," ",(0,i.kt)("em",{parentName:"p"},"TestModule > TestClass > Test")),(0,i.kt)("h2",{id:"core-rules"},"Core Rules"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Tests be created following the ",(0,i.kt)("a",{parentName:"li",href:"https://martinfowler.com/bliki/GivenWhenThen.html"},"GIVEN-WHEN-THEN")," specification"),(0,i.kt)("li",{parentName:"ol"},"Tests should be created for functional units that API or end users can access and not implementation details",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For critical implementation details, create tests in a separate (sub)module"))),(0,i.kt)("li",{parentName:"ol"},"Tests should be validate and check True +ve, False +ve, True -ve and False -ve based on the use case amnd scenario"),(0,i.kt)("li",{parentName:"ol"},"Mock all external API. If need be, test their output/response independently")),(0,i.kt)("h2",{id:"assertions"},"Assertions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"equals & not equals"),(0,i.kt)("li",{parentName:"ul"},"called, called with & not called"),(0,i.kt)("li",{parentName:"ul"},"Is & Is not"),(0,i.kt)("li",{parentName:"ul"},"Is None & Is not None"),(0,i.kt)("li",{parentName:"ul"},"Is instance & Is not instance")),(0,i.kt)("h2",{id:"fixtures"},"Fixtures"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setUp")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"TearDown")," : Called at the  before and after each test"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setUpClass")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"TearDownClass")," : Called at the start of each test class, before and after all test functions within it"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setUpModule")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"TearDownModule")," : Called at the start of each test module, before and after all test classes within it")),(0,i.kt)("h2",{id:"mocks"},"Mocks"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Mock vs Patch == Replaces objects from Current Scope vs Imported Scope")),(0,i.kt)("p",null,"Mocks are used to avoid intereference of test code with unrelated code (application code and external dependencies). In python, remember to mock where the function is used and not where it is from"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Function patch"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def test_fn():\n    with patch("application.testing_location.imported_fn") as patched_function:\n        # test logic\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Multiple patch decorators. They are mapped in LIFO order"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},"@mock.patch('mymodule.os.path')\n@mock.patch('mymodule.os')\ndef test_rm(self, mock_os, mock_path): \n    # test logic\n\n@patch('sys.exit')\n@patch.multiple('__main__', thing=DEFAULT, other=DEFAULT)\n# If you use patch.multiple() as a decorator, then the created mocks are passed by keyword.\ndef test_function(mock_exit, other, thing):\n    # MagicMock merely populates default values for magic functions\n    assert isinstance(thing, MagicMock) \n    assert isinstance(other, MagicMock)\n    assert 'exit' in repr(mock_exit)\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Class patch"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def test_fn():\n    # mock an object of class \n    with patch.object(MyClass, 'method_called', return_value=\"hi i'm a mock object\"):\n        # test logic\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Mock Object"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def test_function_c():\n    mock_obj = Mock()\n    mock_obj.method_in_mocked = Mock(return_value="foo")\n    mock_obj.param_in_mocked = "foo"\n    # mock.method_in_mocked.call_args[0] # returns params passed to mocked method\n')))),(0,i.kt)("h2",{id:"skip-tests"},"Skip Tests"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@unittest.skip(reason)")," : Unconditionally skip the decorated test. reason should describe why the test is being skipped."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@unittest.skipIf(condition, reason)")," : Skip the decorated test if condition is true."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@unittest.skipUnless(condition, reason)"),": Skip the decorated test unless condition is true.")))}d.isMDXComponent=!0}}]);